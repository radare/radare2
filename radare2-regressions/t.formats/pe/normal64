#!/bin/sh
for a in . .. ../.. ; do [ -e $a/tests.sh ] && . $a/tests.sh ; done


NAME='PE: corkami normal64.exe - open'
FILE=../../bins/pe/normal64.exe
ARGS=''
CMDS="q!"
EXPECT=''
run_test

NAME='PE: corkami normal64.exe - bits 64'
FILE=../../bins/pe/normal64.exe
BROKEN=
ARGS='-n'
CMDS="!rabin2 -I ${FILE} | grep bits"

EXPECT='bits     64
'

run_test


NAME='PE: corkami normal64.exe - machine AMD 64'
FILE=../../bins/pe/normal64.exe
ARGS='-n'
CMDS="!rabin2 -I ${FILE} | grep \"machine  AMD 64\" "

EXPECT='machine  AMD 64
'

run_test


NAME='PE: corkami normal64.exe - class PE32+'
FILE=../../bins/pe/normal64.exe
ARGS='-n'
CMDS="!rabin2 -I ${FILE} | grep \"class    PE32+\" "

EXPECT='class    PE32+
'

run_test

NAME='PE: corkami imports'
FILE=../../bins/pe/normal64.exe
ARGS=''
CMDS="iiq"

EXPECT='kernel32.dll_ExitProcess
msvcrt.dll_printf
'

run_test
