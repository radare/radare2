#!/bin/sh

for a in . .. ../.. ; do [ -e $a/tests.sh ] && . $a/tests.sh ; done

NAME='ragg2 -p A200 -d 50:0xccccccb'
CMDS='!ragg2 -p A200 -d 50:0xccccccb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cbcccc0c4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A200 -d 50:0xcb'
CMDS='!ragg2 -p A200 -d 50:0xcb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cb0000004141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A10 -d 50:0xcb'
CMDS='!ragg2 -p A10 -d 50:0xcb'
EXPECT_ERR="Fuck this shit. Cant patch outside"
EXPECT='41414141414141414141
'
run_test

NAME='ragg2 -p A20 -w 10:cb'
CMDS='!ragg2 -p A20 -w 10:cb'
EXPECT='41414141414141414141cb414141414141414141
'
run_test

NAME='ragg2 -p A20 -D 10:33'
CMDS='!ragg2 -p A20 -D 10:33'
EXPECT='4141414141414141414121000000000000004141
'
run_test

NAME='ragg2 -p n2t2a2s2'
CMDS='!ragg2 -p n2t2a2s2'
EXPECT='00004141cccc9090
'
run_test

NAME='ragg2 -i exec -z -a x86 -b32'
CMDS='!ragg2 -i exec -z -k linux -a x86 -b32'
BROKEN=
EXPECT='"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
'
run_test

NAME='ragg2 -k linux -i exec  -a x86 -b32 -p n3N3'
CMDS='!ragg2 -k linux -i exec  -a x86 -b32 -p n3N3'
EXPECT='90909031c050682f2f7368682f62696e89e3505389e199b00bcd80909090
'
run_test


NAME="ragg2 -p n80 -w 79:c3 -x"
CMDS="!ragg2 -p n80 -w 79:c3 -x"
EXPECT=''
run_test

