NAME=p2 hello-linux-x86_64
FILE=bins/elf/analysis/hello-linux-x86_64
CMDS=p2 16
EXPECT=<<EOF
----..==----##..
--==####..####..
==..##..------==
--==####..####--
==..==##--##==##
..----####--====
==..==..########
##..##==--==##--
EOF
RUN

NAME=p= 0xff 0x00
FILE=-
BROKEN=1
CMDS=<<EOF
b 2
wx 0xff
p= 2@0
EOF
EXPECT=<<EOF
         ___________________________________________________
00 00ff | __________________________________________________|
01 0000 ||
EOF
RUN

NAME=p=b 0xff 0x00
FILE=-
CMDS=<<EOF
b 2
wx 0xff
e zoom.in=raw
p=b 2 2@0
EOF
EXPECT=<<EOF
0x00000000 000 00ff |###################################################
0x00000001 001 0000 |#
EOF
RUN

NAME=p= - crash
FILE=-
CMDS=<<EOF
e zoom.in = block
p=p" 1 " 1 EN
EOF
EXPECT=<<EOF
0x00000000 000 0000 |#
EOF
RUN

NAME=p=d
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=p=d 10 @ 0
EXPECT=<<EOF
min:              0  0x0
max:              127  0x7f
unique (count):   6  0x6
range (max-min):  127  0x7f
size (of block):  10  0xa
EOF
RUN

NAME=p=e 5
FILE=bins/elf/arm1.bin
CMDS=p=e 5@0
EXPECT=<<EOF
0x00000000 000 009f |########
0x0001bec1 001 00c3 |#
0x00037d82 002 00c3 |#
0x00053c43 003 00c3 |#######################################
0x0006fb04 004 0051 |################
EOF
RUN

NAME=p=e 5 0x100
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=<<EOF
e zoom.in = block
p=e 5 0x100
EOF
EXPECT=<<EOF
0x00000000 000 007f |#########################
0x00000033 001 006b |###
0x00000066 002 007a |#########################
0x00000099 003 006a |#####################
0x000000cc 004 005f |###################
EOF
RUN

NAME=p=e 5 0x100 1
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=<<EOF
e zoom.in = block
p=e 5 0x100 1
EOF
EXPECT=<<EOF
0x00000000 000 006b |###
0x00000033 001 007a |#########################
0x00000066 002 006a |#####################
0x00000099 003 005f |###################
0x000000cc 004 0059 |##################
EOF
RUN

NAME=p=p 5
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=p=p 5@0
EXPECT=<<EOF
0x00000000 000 0032 |##########
0x0001bec1 001 0031 |#
0x00037d82 002 0035 |###
0x00053c43 003 0040 |###########
0x0006fb04 004 0076 |########################
EOF
RUN

NAME=p=p 5 0x100
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=<<EOF
e zoom.in = block
p=p 5 0x100
EOF
EXPECT=<<EOF
0x00000000 000 0032 |#########
0x00000033 001 0019 |#
0x00000066 002 001e |#
0x00000099 003 001e |##
0x000000cc 004 0028 |########
EOF
RUN

NAME=p=p 5 0x100 1
FILE=bins/elf/arm1.bin
ARGS=-n
CMDS=<<EOF
e zoom.in = block
p=p 5 0x100 1
EOF
EXPECT=<<EOF
0x00000000 000 0019 |#
0x00000033 001 001e |#
0x00000066 002 001e |##
0x00000099 003 0028 |#######
0x000000cc 004 001e |######
EOF
RUN

NAME=p8 10
FILE=malloc://1024
CMDS=wx 90909090909090909090 ; p8 10
EXPECT=<<EOF
90909090909090909090
EOF
RUN

NAME=p8 -10
FILE=malloc://1024
CMDS=wx 90909090909090909090 ; s 10 ; p8 -10
EXPECT=<<EOF
90909090909090909090
EOF
RUN

NAME=pi 3
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f
pi 3
EOF
EXPECT=<<EOF
mov eax, 1
cmp rdx, rcx
jg 0xa
EOF
RUN

NAME=pij 3
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f
pij 3
EOF
EXPECT=<<EOF
[{"offset":0,"val":1,"esil":"1,rax,=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":5,"opcode":"mov eax, 1","disasm":"mov eax, 1","bytes":"b801000000","family":"cpu","type":"mov","reloc":false,"type_num":9,"type2_num":0},{"offset":5,"esil":"rcx,rdx,==,$z,zf,:=,64,$b,cf,:=,$p,pf,:=,63,$s,sf,:=,rcx,0x8000000000000000,-,!,63,$o,^,of,:=,3,$b,af,:=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":3,"opcode":"cmp rdx, rcx","disasm":"cmp rdx, rcx","bytes":"4839ca","family":"cpu","type":"cmp","reloc":false,"type_num":15,"type2_num":0},{"offset":8,"esil":"sf,of,!,^,zf,!,&,?{,10,rip,=,}","refptr":false,"fcn_addr":0,"fcn_last":0,"size":2,"opcode":"jg 0xa","disasm":"jg 0xa","bytes":"7f00","family":"cpu","type":"cjmp","reloc":false,"type_num":2147483649,"type2_num":0,"jump":10,"fail":10}]
EOF
RUN

NAME=pi 6
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f00b8010000004839ca7f00
pi 6
EOF
EXPECT=<<EOF
mov eax, 1
cmp rdx, rcx
jg 0xa
mov eax, 1
cmp rdx, rcx
jg 0x14
EOF
RUN

NAME=pi -5 @ 0x0040050f
FILE=bins/elf/analysis/main
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
pi -5 @ 0x0040050f
EOF
EXPECT=<<EOF
pop rbp
jmp sym.register_tm_clones
push rbp
mov rbp, rsp
mov edi, str.Hello_World
EOF
RUN

NAME=pi -5 @ 0x0040050f (anal)
FILE=bins/elf/analysis/main
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
aaa
pi -5 @ 0x0040050f
EOF
EXPECT=<<EOF
pop rbp
jmp sym.register_tm_clones
push rbp
mov rbp, rsp
mov edi, str.Hello_World
EOF
RUN

NAME=pij -5 @ 0x0040050f
FILE=bins/elf/analysis/main
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
pij -3 @ 0x0040050f
EOF
EXPECT=<<EOF
[{"offset":4195590,"esil":"rbp,8,rsp,-,=[8],8,rsp,-=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":1,"opcode":"push rbp","disasm":"push rbp","bytes":"55","family":"cpu","type":"rpush","reloc":false,"type_num":268435468,"type2_num":0,"flags":["main","sym.main"]},{"offset":4195591,"esil":"rsp,rbp,=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":3,"opcode":"mov rbp, rsp","disasm":"mov rbp, rsp","bytes":"4889e5","family":"cpu","type":"mov","reloc":false,"type_num":9,"type2_num":0},{"offset":4195594,"ptr":4195780,"val":4195780,"esil":"4195780,rdi,=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":5,"opcode":"mov edi, 0x4005c4","disasm":"mov edi, str.Hello_World","bytes":"bfc4054000","family":"cpu","type":"mov","reloc":false,"type_num":9,"type2_num":0}]
EOF
RUN

NAME=pi -5
FILE=bins/elf/analysis/main
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
s 0x0040050f
pi -5
EOF
EXPECT=<<EOF
pop rbp
jmp sym.register_tm_clones
push rbp
mov rbp, rsp
mov edi, str.Hello_World
EOF
RUN

NAME=pif bsz
FILE=malloc://1024
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx 5b415c415d415e415f5dc3
af
b 2
pif
EOF
EXPECT=<<EOF
pop rbx
pop r12
pop r13
pop r14
pop r15
pop rbp
ret
EOF
RUN

NAME=pi~?
FILE=malloc://1024
CMDS=<<EOF
pi 200~?
pi 200~?
pd 200~?
EOF
EXPECT=<<EOF
200
200
200
EOF
RUN

NAME=tmpbits
FILE=-
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
p8 1 @b:32
e asm.bits
EOF
EXPECT=<<EOF
00
64
EOF
RUN

NAME=tmpbits
FILE=-
CMDS=<<EOF
e asm.arch=x86
e asm.bits=32
p8 1 @b:64
e asm.bits
EOF
EXPECT=<<EOF
00
32
EOF
RUN

NAME=pi 3
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f
pi 3
EOF
EXPECT=<<EOF
mov eax, 1
cmp rdx, rcx
jg 0xa
EOF
RUN

NAME=pij 3 (2)
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f
pij 3
EOF
EXPECT=<<EOF
[{"offset":0,"val":1,"esil":"1,rax,=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":5,"opcode":"mov eax, 1","disasm":"mov eax, 1","bytes":"b801000000","family":"cpu","type":"mov","reloc":false,"type_num":9,"type2_num":0},{"offset":5,"esil":"rcx,rdx,==,$z,zf,:=,64,$b,cf,:=,$p,pf,:=,63,$s,sf,:=,rcx,0x8000000000000000,-,!,63,$o,^,of,:=,3,$b,af,:=","refptr":false,"fcn_addr":0,"fcn_last":0,"size":3,"opcode":"cmp rdx, rcx","disasm":"cmp rdx, rcx","bytes":"4839ca","family":"cpu","type":"cmp","reloc":false,"type_num":15,"type2_num":0},{"offset":8,"esil":"sf,of,!,^,zf,!,&,?{,10,rip,=,}","refptr":false,"fcn_addr":0,"fcn_last":0,"size":2,"opcode":"jg 0xa","disasm":"jg 0xa","bytes":"7f00","family":"cpu","type":"cjmp","reloc":false,"type_num":2147483649,"type2_num":0,"jump":10,"fail":10}]
EOF
RUN

NAME=pi 6
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f00b8010000004839ca7f00
pi 6
EOF
EXPECT=<<EOF
mov eax, 1
cmp rdx, rcx
jg 0xa
mov eax, 1
cmp rdx, rcx
jg 0x14
EOF
RUN

NAME=pi -3 @ 3
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f00
pi -3 @ 10
EOF
EXPECT=<<EOF
add byte [rax], al
cmp rdx, rcx
jg 0xa
EOF
RUN

NAME=pij -3 @ 3
FILE=malloc://512
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx b8010000004839ca7f00
pij -3 @ 10~{}
EOF
EXPECT=<<EOF
[
  {
    "offset": 3,
    "esil": "al,rax,+=[1],7,$o,of,:=,7,$s,sf,:=,$z,zf,:=,7,$c,cf,:=,$p,pf,:=,3,$c,af,:=",
    "refptr": true,
    "fcn_addr": 0,
    "fcn_last": 0,
    "size": 2,
    "opcode": "add byte [rax], al",
    "disasm": "add byte [rax], al",
    "bytes": "0000",
    "family": "cpu",
    "type": "add",
    "reloc": false,
    "type_num": 17,
    "type2_num": 0
  },
  {
    "offset": 5,
    "esil": "rcx,rdx,==,$z,zf,:=,64,$b,cf,:=,$p,pf,:=,63,$s,sf,:=,rcx,0x8000000000000000,-,!,63,$o,^,of,:=,3,$b,af,:=",
    "refptr": false,
    "fcn_addr": 0,
    "fcn_last": 0,
    "size": 3,
    "opcode": "cmp rdx, rcx",
    "disasm": "cmp rdx, rcx",
    "bytes": "4839ca",
    "family": "cpu",
    "type": "cmp",
    "reloc": false,
    "type_num": 15,
    "type2_num": 0
  },
  {
    "offset": 8,
    "esil": "sf,of,!,^,zf,!,&,?{,10,rip,=,}",
    "refptr": false,
    "fcn_addr": 0,
    "fcn_last": 0,
    "size": 2,
    "opcode": "jg 0xa",
    "disasm": "jg 0xa",
    "bytes": "7f00",
    "family": "cpu",
    "type": "cjmp",
    "reloc": false,
    "type_num": 2147483649,
    "type2_num": 0,
    "jump": 10,
    "fail": 10
  }
]
EOF
RUN

NAME=pi -10
FILE=malloc://1024
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx 90909090909090909090 ; s 10 ; pi -10
EOF
EXPECT=<<EOF
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
EOF
RUN

NAME=pif bsz
FILE=malloc://1024
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx 5b415c415d415e415f5dc3
af
b 2
pif
EOF
EXPECT=<<EOF
pop rbx
pop r12
pop r13
pop r14
pop r15
pop rbp
ret
EOF
RUN

NAME=pi~?
FILE=malloc://1024
CMDS=<<EOF
pi 200~?
pi 200~?
pd 200~?
EOF
EXPECT=<<EOF
200
200
200
EOF
RUN

NAME=tmpbits
FILE=-
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
p8 1 @b:32
e asm.bits
EOF
EXPECT=<<EOF
00
64
EOF
RUN

NAME=tmpbits
FILE=-
CMDS=<<EOF
e asm.arch=x86
e asm.bits=32
p8 1 @b:64
e asm.bits
EOF
EXPECT=<<EOF
00
32
EOF
RUN

NAME=pm hello.c
FILE=bins/src/hello.c
CMDS=pm
EXPECT=<<EOF
0x00000000 1 C source code
EOF
RUN

NAME=pm elf/main
FILE=bins/elf/analysis/main
ARGS=-n
CMDS=pm
EXPECT=<<EOF
0x00000000 1 ELF 64-bit LSB executable, x86-64, version 1
EOF
RUN

NAME=pm mach0/fatmach0-3true
FILE=bins/mach0/fatmach0-3true
ARGS=-n
CMDS=pm
EXPECT=<<EOF
0x00000000 1 Fat-Mach-O
EOF
RUN

NAME=pm java/Hello.class
FILE=bins/java/Hello.class
ARGS=-n
CMDS=pm
EXPECT=<<EOF
0x00000000 1 Java CLASS
EOF
RUN

NAME=pm pe/a.exe
FILE=bins/pe/a.exe
ARGS=-n
CMDS=pm
EXPECT=<<EOF
0x00000000 1 PE  for MS Windows (console) Intel 80386 32-bit
EOF
RUN

NAME=print raw lines
FILE=bins/other/projects/resetc64
CMDS=<<EOF
sl 5
prl 1~[0]
e lines.abs=true
prl 1~[0]
EOF
EXPECT=<<EOF
+1
5
EOF
RUN

NAME=pib from beginning of bb
FILE=bins/elf/analysis/x64-loop
CMDS=<<EOF
s main
af
pib
EOF
EXPECT=<<EOF
push rbp
mov rbp, rsp
sub rsp, 0x20
mov dword [var_14h], edi
mov qword [var_20h], rsi
mov dword [var_4h], 0
jmp 0x400523
EOF
RUN

NAME=pib inside bb
FILE=bins/elf/analysis/x64-loop
CMDS=<<EOF
s main
af
so 2
pib
EOF
EXPECT=<<EOF
sub rsp, 0x20
mov dword [var_14h], edi
mov qword [var_20h], rsi
mov dword [var_4h], 0
jmp 0x400523
EOF
RUN

NAME=pI size > bocksize
FILE=malloc://1024
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
wx 90909090909090909090
b 1
pI 10
EOF
EXPECT=<<EOF
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
EOF
RUN

NAME=p- with "r2 --"
FILE=--
CMDS=p-
EXPECT=<<EOF
EOF
RUN

NAME=p- with malloc://512
FILE=malloc://512
CMDS=p-
EXPECT=<<EOF
0x00000000 [^_____________________________________________] 0x00000200
EOF
RUN

NAME=psW 32 widestring
FILE=bins/elf/crackme0x00b
CMDS=psW @ obj.pass.1964
EXPECT=<<EOF
w0wgreat
EOF
RUN

NAME=psW 32 widestring leading zeros
FILE=bins/elf/crackme0x00b
CMDS=psW @ 0x0804a03e
EXPECT=<<EOF
w0wgreat
EOF
RUN

NAME=ps leading zeros
BROKEN=1
FILE=bins/elf/crackme0x00b
CMDS=ps @ 0x0804a03e
EXPECT=<<EOF
w
EOF
RUN

NAME=io.unalloc, io.unalloc.ch and prc
FILE=bins/elf/analysis/tiny.elf
CMDS=<<EOF
. scripts/palette.r2
(print; prc 0x00010032-0x0000fffa @ 0x0000fffa)
e io.unalloc=true
e scr.color=0
.(print)
?e
e io.unalloc.ch=-
.(print)
?e
e scr.color=3
e io.unalloc.ch=
.(print)
?e
e io.unalloc.ch=?
.(print)
EOF
EXPECT=<<EOF
0x0000fffa ????????????se,,,,,,            
0x0001000a                     ..      ..  
0x0001001a             en....OO,,OO;;  ..  
0x0001002a ..              

0x0000fffa ------------se,,,,,,            
0x0001000a                     ..      ..  
0x0001001a             en....OO,,OO;;  ..  
0x0001002a ..              

[38;2;19;161;14m0x0000fffa[0m [0m..[0m..[0m..[0m..[0m..[0m..[38;2;0;0;0m[48;2;149;254;184m[38;2;0;0;0mse[38;2;0;0;0m[48;2;103;155;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;192;255;67m[38;2;0;0;0m  [38;2;0;0;0m[48;2;117;176;0m[38;2;0;0;0m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001000a[0m [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;117;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001001a[0m [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;29;117m[38;2;240;240;240men[38;2;0;0;0m[48;2;255;195;15m[38;2;0;0;0m  [38;2;240;240;240m[48;2;86;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;25;0;76m[38;2;240;240;240m  [38;2;240;240;240m[48;2;50;76;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;147;94;255m[38;2;0;0;0m  [38;2;240;240;240m[48;2;0;76;76m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;135;135;0m[38;2;0;0;0m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001002a[0m [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m

[38;2;19;161;14m0x0000fffa[0m [0m??[0m??[0m??[0m??[0m??[0m??[38;2;0;0;0m[48;2;149;254;184m[38;2;0;0;0mse[38;2;0;0;0m[48;2;103;155;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;192;255;67m[38;2;0;0;0m  [38;2;0;0;0m[48;2;117;176;0m[38;2;0;0;0m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001000a[0m [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;117;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001001a[0m [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;29;117m[38;2;240;240;240men[38;2;0;0;0m[48;2;255;195;15m[38;2;0;0;0m  [38;2;240;240;240m[48;2;86;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;25;0;76m[38;2;240;240;240m  [38;2;240;240;240m[48;2;50;76;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;147;94;255m[38;2;0;0;0m  [38;2;240;240;240m[48;2;0;76;76m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;135;135;0m[38;2;0;0;0m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
[38;2;19;161;14m0x0001002a[0m [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240m  [0m
EOF
RUN

NAME=prc text color
FILE=-
CMDS=<<EOF
. scripts/palette.r2
woe 0 0xff 1
(test_flag; f i`p8 1`)
.(test_flag) @@s:0 0xff 2
e scr.color=3
pxa 256
prc 256
EOF
EXPECT=<<EOF
[32m- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF[0m
             /i00 /i02 /i04 /i06 /i08 /i0a /i0c /i0e                
[38;2;19;161;14m0x00000000[0m  [7m[38;2;0;0;128m00[27m[0m[38;2;19;161;14m01 [7m02[27m[0m[38;2;204;204;204m03 [7m04[27m[0m[38;2;204;204;204m05 [7m06[27m[0m[38;2;204;204;204m07 [7m08[27m[0m[38;2;204;204;204m09 [7m0a[27m[0m[38;2;204;204;204m0b [7m0c[27m[0m[38;2;204;204;204m0d [7m0e[27m[0m[38;2;204;204;204m0f[0m  [7m[38;2;0;0;128m[27m.[0m[38;2;19;161;14m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /i10 /i12 /i14 /i16 /i18 /i1a /i1c /i1e                
[38;2;19;161;14m0x00000010[0m  [7m[38;2;197;15;31m10[27m[0m[38;2;204;204;204m11 [7m12[27m[0m[38;2;204;204;204m13 [7m14[27m[0m[38;2;204;204;204m15 [7m16[27m[0m[38;2;204;204;204m17 [7m18[27m[0m[38;2;204;204;204m19 [7m1a[27m[0m[38;2;204;204;204m1b [7m1c[27m[0m[38;2;204;204;204m1d [7m1e[27m[0m[38;2;204;204;204m1f[0m  [7m[38;2;197;15;31m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /i20 /i22 /i24 /i26 /i28 /i2a /i2c /i2e                
[38;2;19;161;14m0x00000020[0m  [7m[38;2;136;23;152m20[27m[0m[38;2;193;156;0m21 [7m22[27m[0m[38;2;193;156;0m23 [7m24[27m[0m[38;2;193;156;0m25 [7m26[27m[0m[38;2;193;156;0m27 [7m28[27m[0m[38;2;193;156;0m29 [7m2a[27m[0m[38;2;193;156;0m2b [7m2c[27m[0m[38;2;193;156;0m2d [7m2e[27m[0m[38;2;193;156;0m2f[0m  [7m[38;2;136;23;152m[27m [0m[38;2;193;156;0m![7m[27m"[0m[38;2;193;156;0m#[7m[27m$[0m[38;2;193;156;0m%[7m[27m&[0m[38;2;193;156;0m'[7m[27m([0m[38;2;193;156;0m)[7m[27m*[0m[38;2;193;156;0m+[7m[27m,[0m[38;2;193;156;0m-[7m[27m.[0m[38;2;193;156;0m/[0m
             /i30 /i32 /i34 /i36 /i38 /i3a /i3c /i3e                
[38;2;19;161;14m0x00000030[0m  [7m[38;2;48;48;48m30[27m[0m[38;2;193;156;0m31 [7m32[27m[0m[38;2;193;156;0m33 [7m34[27m[0m[38;2;193;156;0m35 [7m36[27m[0m[38;2;193;156;0m37 [7m38[27m[0m[38;2;193;156;0m39 [7m3a[27m[0m[38;2;193;156;0m3b [7m3c[27m[0m[38;2;193;156;0m3d [7m3e[27m[0m[38;2;193;156;0m3f[0m  [7m[38;2;48;48;48m[27m0[0m[38;2;193;156;0m1[7m[27m2[0m[38;2;193;156;0m3[7m[27m4[0m[38;2;193;156;0m5[7m[27m6[0m[38;2;193;156;0m7[7m[27m8[0m[38;2;193;156;0m9[7m[27m:[0m[38;2;193;156;0m;[7m[27m<[0m[38;2;193;156;0m=[7m[27m>[0m[38;2;193;156;0m?[0m
             /i40 /i42 /i44 /i46 /i48 /i4a /i4c /i4e                
[38;2;19;161;14m0x00000040[0m  [7m[38;2;19;161;14m40[27m[0m[38;2;193;156;0m41 [7m42[27m[0m[38;2;193;156;0m43 [7m44[27m[0m[38;2;193;156;0m45 [7m46[27m[0m[38;2;193;156;0m47 [7m48[27m[0m[38;2;193;156;0m49 [7m4a[27m[0m[38;2;193;156;0m4b [7m4c[27m[0m[38;2;193;156;0m4d [7m4e[27m[0m[38;2;193;156;0m4f[0m  [7m[38;2;19;161;14m[27m@[0m[38;2;193;156;0mA[7m[27mB[0m[38;2;193;156;0mC[7m[27mD[0m[38;2;193;156;0mE[7m[27mF[0m[38;2;193;156;0mG[7m[27mH[0m[38;2;193;156;0mI[7m[27mJ[0m[38;2;193;156;0mK[7m[27mL[0m[38;2;193;156;0mM[7m[27mN[0m[38;2;193;156;0mO[0m
             /i50 /i52 /i54 /i56 /i58 /i5a /i5c /i5e                
[38;2;19;161;14m0x00000050[0m  [7m[38;2;0;0;128m50[27m[0m[38;2;193;156;0m51 [7m52[27m[0m[38;2;193;156;0m53 [7m54[27m[0m[38;2;193;156;0m55 [7m56[27m[0m[38;2;193;156;0m57 [7m58[27m[0m[38;2;193;156;0m59 [7m5a[27m[0m[38;2;193;156;0m5b [7m5c[27m[0m[38;2;193;156;0m5d [7m5e[27m[0m[38;2;193;156;0m5f[0m  [7m[38;2;0;0;128m[27mP[0m[38;2;193;156;0mQ[7m[27mR[0m[38;2;193;156;0mS[7m[27mT[0m[38;2;193;156;0mU[7m[27mV[0m[38;2;193;156;0mW[7m[27mX[0m[38;2;193;156;0mY[7m[27mZ[0m[38;2;193;156;0m[[7m[27m\[0m[38;2;193;156;0m][7m[27m^[0m[38;2;193;156;0m_[0m
             /i60 /i62 /i64 /i66 /i68 /i6a /i6c /i6e                
[38;2;19;161;14m0x00000060[0m  [7m[38;2;197;15;31m60[27m[0m[38;2;193;156;0m61 [7m62[27m[0m[38;2;193;156;0m63 [7m64[27m[0m[38;2;193;156;0m65 [7m66[27m[0m[38;2;193;156;0m67 [7m68[27m[0m[38;2;193;156;0m69 [7m6a[27m[0m[38;2;193;156;0m6b [7m6c[27m[0m[38;2;193;156;0m6d [7m6e[27m[0m[38;2;193;156;0m6f[0m  [7m[38;2;197;15;31m[27m`[0m[38;2;193;156;0ma[7m[27mb[0m[38;2;193;156;0mc[7m[27md[0m[38;2;193;156;0me[7m[27mf[0m[38;2;193;156;0mg[7m[27mh[0m[38;2;193;156;0mi[7m[27mj[0m[38;2;193;156;0mk[7m[27ml[0m[38;2;193;156;0mm[7m[27mn[0m[38;2;193;156;0mo[0m
             /i70 /i72 /i74 /i76 /i78 /i7a /i7c /i7e                
[38;2;19;161;14m0x00000070[0m  [7m[38;2;136;23;152m70[27m[0m[38;2;193;156;0m71 [7m72[27m[0m[38;2;193;156;0m73 [7m74[27m[0m[38;2;193;156;0m75 [7m76[27m[0m[38;2;193;156;0m77 [7m78[27m[0m[38;2;193;156;0m79 [7m7a[27m[0m[38;2;193;156;0m7b [7m7c[27m[0m[38;2;193;156;0m7d [7m7e[27m[0m[38;2;193;156;0m7f[0m  [7m[38;2;136;23;152m[27mp[0m[38;2;193;156;0mq[7m[27mr[0m[38;2;193;156;0ms[7m[27mt[0m[38;2;193;156;0mu[7m[27mv[0m[38;2;193;156;0mw[7m[27mx[0m[38;2;193;156;0my[7m[27mz[0m[38;2;193;156;0m{[7m[27m|[0m[38;2;193;156;0m}[7m[27m~[0m[38;2;193;156;0m.[0m
             /i80 /i82 /i84 /i86 /i88 /i8a /i8c /i8e                
[38;2;19;161;14m0x00000080[0m  [7m[38;2;48;48;48m80[27m[0m[38;2;204;204;204m81 [7m82[27m[0m[38;2;204;204;204m83 [7m84[27m[0m[38;2;204;204;204m85 [7m86[27m[0m[38;2;204;204;204m87 [7m88[27m[0m[38;2;204;204;204m89 [7m8a[27m[0m[38;2;204;204;204m8b [7m8c[27m[0m[38;2;204;204;204m8d [7m8e[27m[0m[38;2;204;204;204m8f[0m  [7m[38;2;48;48;48m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /i90 /i92 /i94 /i96 /i98 /i9a /i9c /i9e                
[38;2;19;161;14m0x00000090[0m  [7m[38;2;19;161;14m90[27m[0m[38;2;204;204;204m91 [7m92[27m[0m[38;2;204;204;204m93 [7m94[27m[0m[38;2;204;204;204m95 [7m96[27m[0m[38;2;204;204;204m97 [7m98[27m[0m[38;2;204;204;204m99 [7m9a[27m[0m[38;2;204;204;204m9b [7m9c[27m[0m[38;2;204;204;204m9d [7m9e[27m[0m[38;2;204;204;204m9f[0m  [7m[38;2;19;161;14m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /ia0 /ia2 /ia4 /ia6 /ia8 /iaa /iac /iae                
[38;2;19;161;14m0x000000a0[0m  [7m[38;2;0;0;128ma0[27m[0m[38;2;204;204;204ma1 [7ma2[27m[0m[38;2;204;204;204ma3 [7ma4[27m[0m[38;2;204;204;204ma5 [7ma6[27m[0m[38;2;204;204;204ma7 [7ma8[27m[0m[38;2;204;204;204ma9 [7maa[27m[0m[38;2;204;204;204mab [7mac[27m[0m[38;2;204;204;204mad [7mae[27m[0m[38;2;204;204;204maf[0m  [7m[38;2;0;0;128m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /ib0 /ib2 /ib4 /ib6 /ib8 /iba /ibc /ibe                
[38;2;19;161;14m0x000000b0[0m  [7m[38;2;197;15;31mb0[27m[0m[38;2;204;204;204mb1 [7mb2[27m[0m[38;2;204;204;204mb3 [7mb4[27m[0m[38;2;204;204;204mb5 [7mb6[27m[0m[38;2;204;204;204mb7 [7mb8[27m[0m[38;2;204;204;204mb9 [7mba[27m[0m[38;2;204;204;204mbb [7mbc[27m[0m[38;2;204;204;204mbd [7mbe[27m[0m[38;2;204;204;204mbf[0m  [7m[38;2;197;15;31m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /ic0 /ic2 /ic4 /ic6 /ic8 /ica /icc /ice                
[38;2;19;161;14m0x000000c0[0m  [7m[38;2;136;23;152mc0[27m[0m[38;2;204;204;204mc1 [7mc2[27m[0m[38;2;204;204;204mc3 [7mc4[27m[0m[38;2;204;204;204mc5 [7mc6[27m[0m[38;2;204;204;204mc7 [7mc8[27m[0m[38;2;204;204;204mc9 [7mca[27m[0m[38;2;204;204;204mcb [7mcc[27m[0m[38;2;204;204;204mcd [7mce[27m[0m[38;2;204;204;204mcf[0m  [7m[38;2;136;23;152m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /id0 /id2 /id4 /id6 /id8 /ida /idc /ide                
[38;2;19;161;14m0x000000d0[0m  [7m[38;2;48;48;48md0[27m[0m[38;2;204;204;204md1 [7md2[27m[0m[38;2;204;204;204md3 [7md4[27m[0m[38;2;204;204;204md5 [7md6[27m[0m[38;2;204;204;204md7 [7md8[27m[0m[38;2;204;204;204md9 [7mda[27m[0m[38;2;204;204;204mdb [7mdc[27m[0m[38;2;204;204;204mdd [7mde[27m[0m[38;2;204;204;204mdf[0m  [7m[38;2;48;48;48m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /ie0 /ie2 /ie4 /ie6 /ie8 /iea /iec /iee                
[38;2;19;161;14m0x000000e0[0m  [7m[38;2;19;161;14me0[27m[0m[38;2;204;204;204me1 [7me2[27m[0m[38;2;204;204;204me3 [7me4[27m[0m[38;2;204;204;204me5 [7me6[27m[0m[38;2;204;204;204me7 [7me8[27m[0m[38;2;204;204;204me9 [7mea[27m[0m[38;2;204;204;204meb [7mec[27m[0m[38;2;204;204;204med [7mee[27m[0m[38;2;204;204;204mef[0m  [7m[38;2;19;161;14m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
             /if0 /if2 /if4 /if6 /if8 /ifa /ifc /ife                
[38;2;19;161;14m0x000000f0[0m  [7m[38;2;0;0;128mf0[27m[0m[38;2;204;204;204mf1 [7mf2[27m[0m[38;2;204;204;204mf3 [7mf4[27m[0m[38;2;204;204;204mf5 [7mf6[27m[0m[38;2;204;204;204mf7 [7mf8[27m[0m[38;2;204;204;204mf9 [7mfa[27m[0m[38;2;204;204;204mfb [7mfc[27m[0m[38;2;204;204;204mfd [7mfe[27m[0m[38;2;204;204;204mff[0m  [7m[38;2;0;0;128m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[7m[27m.[0m[38;2;204;204;204m.[0m
[38;2;19;161;14m0x00000000[0m [38;2;240;240;240m[48;2;0;0;0m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;86;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;0;0m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;117;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;0;0m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;155;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;176;0;0m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;198;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;221;0;0m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;245;0;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;255;15;15m[38;2;240;240;240mi0[38;2;240;240;240m[48;2;255;40;40m[38;2;240;240;240m  [38;2;0;0;0m[48;2;255;67;67m[38;2;0;0;0mi0[38;2;0;0;0m[48;2;255;94;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;121;121m[38;2;0;0;0mi0[38;2;0;0;0m[48;2;254;149;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000010[0m [38;2;240;240;240m[48;2;76;22;0m[38;2;240;240;240mi1[38;2;240;240;240m[48;2;86;25;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;30;0m[38;2;240;240;240mi1[38;2;240;240;240m[48;2;117;35;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;40;0m[38;2;240;240;240mi1[38;2;240;240;240m[48;2;155;46;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;176;52;0m[38;2;240;240;240mi1[38;2;240;240;240m[48;2;198;59;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;221;66;0m[38;2;240;240;240mi1[38;2;0;0;0m[48;2;245;73;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;87;15m[38;2;0;0;0mi1[38;2;0;0;0m[48;2;255;105;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;123;67m[38;2;0;0;0mi1[38;2;0;0;0m[48;2;255;142;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;161;121m[38;2;0;0;0mi1[38;2;0;0;0m[48;2;254;181;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000020[0m [38;2;240;240;240m[48;2;76;57;0m[38;2;240;240;240mi2[38;2;240;240;240m[48;2;86;64;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;75;0m[38;2;240;240;240mi2[38;2;240;240;240m[48;2;117;87;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;101;0m[38;2;240;240;240mi2[38;2;0;0;0m[48;2;155;116;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;176;132;0m[38;2;0;0;0mi2[38;2;0;0;0m[48;2;198;148;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;221;166;0m[38;2;0;0;0mi2[38;2;0;0;0m[48;2;245;184;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;195;15m[38;2;0;0;0mi2[38;2;0;0;0m[48;2;255;201;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;208;67m[38;2;0;0;0mi2[38;2;0;0;0m[48;2;255;214;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;221;121m[38;2;0;0;0mi2[38;2;0;0;0m[48;2;254;228;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000030[0m [38;2;240;240;240m[48;2;76;76;0m[38;2;240;240;240mi3[38;2;240;240;240m[48;2;86;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;100;0m[38;2;240;240;240mi3[38;2;240;240;240m[48;2;117;117;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;135;135;0m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;155;155;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;176;176;0m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;198;198;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;221;221;0m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;245;245;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;255;15m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;255;255;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;255;67m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;255;255;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;255;121m[38;2;0;0;0mi3[38;2;0;0;0m[48;2;255;254;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000040[0m [38;2;240;240;240m[48;2;50;76;0m[38;2;240;240;240mi4[38;2;240;240;240m[48;2;57;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;66;100;0m[38;2;240;240;240mi4[38;2;240;240;240m[48;2;78;117;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;90;135;0m[38;2;240;240;240mi4[38;2;0;0;0m[48;2;103;155;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;117;176;0m[38;2;0;0;0mi4[38;2;0;0;0m[48;2;132;198;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;147;221;0m[38;2;0;0;0mi4[38;2;0;0;0m[48;2;163;245;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;175;255;15m[38;2;0;0;0mi4[38;2;0;0;0m[48;2;183;255;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;192;255;67m[38;2;0;0;0mi4[38;2;0;0;0m[48;2;201;255;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;210;255;121m[38;2;0;0;0mi4[38;2;0;0;0m[48;2;219;254;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000050[0m [38;2;240;240;240m[48;2;31;76;0m[38;2;240;240;240mi5[38;2;240;240;240m[48;2;35;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;41;100;0m[38;2;240;240;240mi5[38;2;240;240;240m[48;2;48;117;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;56;135;0m[38;2;240;240;240mi5[38;2;240;240;240m[48;2;64;155;0m[38;2;240;240;240m  [38;2;0;0;0m[48;2;73;176;0m[38;2;0;0;0mi5[38;2;0;0;0m[48;2;82;198;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;92;221;0m[38;2;0;0;0mi5[38;2;0;0;0m[48;2;102;245;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;115;255;15m[38;2;0;0;0mi5[38;2;0;0;0m[48;2;130;255;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;145;255;67m[38;2;0;0;0mi5[38;2;0;0;0m[48;2;161;255;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;177;255;121m[38;2;0;0;0mi5[38;2;0;0;0m[48;2;193;254;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000060[0m [38;2;240;240;240m[48;2;0;76;0m[38;2;240;240;240mi6[38;2;240;240;240m[48;2;0;86;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;100;0m[38;2;240;240;240mi6[38;2;240;240;240m[48;2;0;117;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;135;0m[38;2;240;240;240mi6[38;2;240;240;240m[48;2;0;155;0m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;176;0m[38;2;240;240;240mi6[38;2;0;0;0m[48;2;0;198;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;0;221;0m[38;2;0;0;0mi6[38;2;0;0;0m[48;2;0;245;0m[38;2;0;0;0m  [38;2;0;0;0m[48;2;15;255;15m[38;2;0;0;0mi6[38;2;0;0;0m[48;2;40;255;40m[38;2;0;0;0m  [38;2;0;0;0m[48;2;67;255;67m[38;2;0;0;0mi6[38;2;0;0;0m[48;2;94;255;94m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;255;121m[38;2;0;0;0mi6[38;2;0;0;0m[48;2;149;254;149m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000070[0m [38;2;240;240;240m[48;2;0;76;25m[38;2;240;240;240mi7[38;2;240;240;240m[48;2;0;86;28m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;100;33m[38;2;240;240;240mi7[38;2;240;240;240m[48;2;0;117;39m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;135;45m[38;2;240;240;240mi7[38;2;240;240;240m[48;2;0;155;51m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;176;58m[38;2;240;240;240mi7[38;2;0;0;0m[48;2;0;198;66m[38;2;0;0;0m  [38;2;0;0;0m[48;2;0;221;73m[38;2;0;0;0mi7[38;2;0;0;0m[48;2;0;245;81m[38;2;0;0;0m  [38;2;0;0;0m[48;2;15;255;95m[38;2;0;0;0mi7[38;2;0;0;0m[48;2;40;255;112m[38;2;0;0;0m  [38;2;0;0;0m[48;2;67;255;129m[38;2;0;0;0mi7[38;2;0;0;0m[48;2;94;255;147m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;255;166m[38;2;0;0;0mi7[38;2;0;0;0m[48;2;149;254;184m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000080[0m [38;2;240;240;240m[48;2;0;76;76m[38;2;240;240;240mi8[38;2;240;240;240m[48;2;0;86;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;100;100m[38;2;240;240;240mi8[38;2;240;240;240m[48;2;0;117;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;135;135m[38;2;240;240;240mi8[38;2;0;0;0m[48;2;0;155;155m[38;2;0;0;0m  [38;2;0;0;0m[48;2;0;176;176m[38;2;0;0;0mi8[38;2;0;0;0m[48;2;0;198;198m[38;2;0;0;0m  [38;2;0;0;0m[48;2;0;221;221m[38;2;0;0;0mi8[38;2;0;0;0m[48;2;0;245;245m[38;2;0;0;0m  [38;2;0;0;0m[48;2;15;255;254m[38;2;0;0;0mi8[38;2;0;0;0m[48;2;40;255;254m[38;2;0;0;0m  [38;2;0;0;0m[48;2;67;255;254m[38;2;0;0;0mi8[38;2;0;0;0m[48;2;94;255;254m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;255;255m[38;2;0;0;0mi8[38;2;0;0;0m[48;2;149;255;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x00000090[0m [38;2;240;240;240m[48;2;0;57;76m[38;2;240;240;240mi9[38;2;240;240;240m[48;2;0;64;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;75;100m[38;2;240;240;240mi9[38;2;240;240;240m[48;2;0;87;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;101;135m[38;2;240;240;240mi9[38;2;240;240;240m[48;2;0;116;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;132;176m[38;2;240;240;240mi9[38;2;0;0;0m[48;2;0;148;198m[38;2;0;0;0m  [38;2;0;0;0m[48;2;0;166;221m[38;2;0;0;0mi9[38;2;0;0;0m[48;2;0;184;245m[38;2;0;0;0m  [38;2;0;0;0m[48;2;15;195;255m[38;2;0;0;0mi9[38;2;0;0;0m[48;2;40;201;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;67;208;255m[38;2;0;0;0mi9[38;2;0;0;0m[48;2;94;214;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;221;255m[38;2;0;0;0mi9[38;2;0;0;0m[48;2;149;228;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000a0[0m [38;2;240;240;240m[48;2;0;38;76m[38;2;240;240;240mia[38;2;240;240;240m[48;2;0;43;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;50;100m[38;2;240;240;240mia[38;2;240;240;240m[48;2;0;58;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;67;135m[38;2;240;240;240mia[38;2;240;240;240m[48;2;0;77;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;88;176m[38;2;240;240;240mia[38;2;240;240;240m[48;2;0;99;198m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;110;221m[38;2;240;240;240mia[38;2;240;240;240m[48;2;0;122;245m[38;2;240;240;240m  [38;2;0;0;0m[48;2;15;135;255m[38;2;0;0;0mia[38;2;0;0;0m[48;2;40;147;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;67;161;255m[38;2;0;0;0mia[38;2;0;0;0m[48;2;94;174;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;188;255m[38;2;0;0;0mia[38;2;0;0;0m[48;2;149;202;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000b0[0m [38;2;240;240;240m[48;2;0;19;76m[38;2;240;240;240mib[38;2;240;240;240m[48;2;0;21;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;25;100m[38;2;240;240;240mib[38;2;240;240;240m[48;2;0;29;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;33;135m[38;2;240;240;240mib[38;2;240;240;240m[48;2;0;38;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;44;176m[38;2;240;240;240mib[38;2;240;240;240m[48;2;0;49;198m[38;2;240;240;240m  [38;2;240;240;240m[48;2;0;55;221m[38;2;240;240;240mib[38;2;240;240;240m[48;2;0;61;245m[38;2;240;240;240m  [38;2;240;240;240m[48;2;15;75;255m[38;2;240;240;240mib[38;2;240;240;240m[48;2;40;94;255m[38;2;240;240;240m  [38;2;0;0;0m[48;2;67;114;255m[38;2;0;0;0mib[38;2;0;0;0m[48;2;94;134;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;121;154;255m[38;2;0;0;0mib[38;2;0;0;0m[48;2;149;176;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000c0[0m [38;2;240;240;240m[48;2;25;0;76m[38;2;240;240;240mic[38;2;240;240;240m[48;2;28;0;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;33;0;100m[38;2;240;240;240mic[38;2;240;240;240m[48;2;39;0;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;45;0;135m[38;2;240;240;240mic[38;2;240;240;240m[48;2;51;0;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;58;0;176m[38;2;240;240;240mic[38;2;240;240;240m[48;2;66;0;198m[38;2;240;240;240m  [38;2;240;240;240m[48;2;73;0;221m[38;2;240;240;240mic[38;2;240;240;240m[48;2;81;0;245m[38;2;240;240;240m  [38;2;240;240;240m[48;2;95;15;255m[38;2;240;240;240mic[38;2;240;240;240m[48;2;112;40;255m[38;2;240;240;240m  [38;2;0;0;0m[48;2;129;67;255m[38;2;0;0;0mic[38;2;0;0;0m[48;2;147;94;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;166;121;255m[38;2;0;0;0mic[38;2;0;0;0m[48;2;184;149;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000d0[0m [38;2;240;240;240m[48;2;51;0;76m[38;2;240;240;240mid[38;2;240;240;240m[48;2;57;0;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;66;0;100m[38;2;240;240;240mid[38;2;240;240;240m[48;2;78;0;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;90;0;135m[38;2;240;240;240mid[38;2;240;240;240m[48;2;103;0;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;117;0;176m[38;2;240;240;240mid[38;2;240;240;240m[48;2;132;0;198m[38;2;240;240;240m  [38;2;240;240;240m[48;2;147;0;221m[38;2;240;240;240mid[38;2;240;240;240m[48;2;163;0;245m[38;2;240;240;240m  [38;2;240;240;240m[48;2;175;15;255m[38;2;240;240;240mid[38;2;0;0;0m[48;2;183;40;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;192;67;255m[38;2;0;0;0mid[38;2;0;0;0m[48;2;201;94;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;210;121;255m[38;2;0;0;0mid[38;2;0;0;0m[48;2;219;149;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000e0[0m [38;2;240;240;240m[48;2;76;0;76m[38;2;240;240;240mie[38;2;240;240;240m[48;2;86;0;86m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;0;100m[38;2;240;240;240mie[38;2;240;240;240m[48;2;117;0;117m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;0;135m[38;2;240;240;240mie[38;2;240;240;240m[48;2;155;0;155m[38;2;240;240;240m  [38;2;240;240;240m[48;2;176;0;176m[38;2;240;240;240mie[38;2;240;240;240m[48;2;198;0;198m[38;2;240;240;240m  [38;2;240;240;240m[48;2;221;0;221m[38;2;240;240;240mie[38;2;240;240;240m[48;2;245;0;245m[38;2;240;240;240m  [38;2;0;0;0m[48;2;254;15;255m[38;2;0;0;0mie[38;2;0;0;0m[48;2;254;40;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;254;67;255m[38;2;0;0;0mie[38;2;0;0;0m[48;2;254;94;255m[38;2;0;0;0m  [38;2;0;0;0m[48;2;254;121;255m[38;2;0;0;0mie[38;2;0;0;0m[48;2;254;149;254m[38;2;0;0;0m  [0m
[38;2;19;161;14m0x000000f0[0m [38;2;240;240;240m[48;2;76;0;50m[38;2;240;240;240mif[38;2;240;240;240m[48;2;86;0;57m[38;2;240;240;240m  [38;2;240;240;240m[48;2;100;0;66m[38;2;240;240;240mif[38;2;240;240;240m[48;2;117;0;78m[38;2;240;240;240m  [38;2;240;240;240m[48;2;135;0;90m[38;2;240;240;240mif[38;2;240;240;240m[48;2;155;0;103m[38;2;240;240;240m  [38;2;240;240;240m[48;2;176;0;117m[38;2;240;240;240mif[38;2;240;240;240m[48;2;198;0;132m[38;2;240;240;240m  [38;2;240;240;240m[48;2;221;0;147m[38;2;240;240;240mif[38;2;240;240;240m[48;2;245;0;163m[38;2;240;240;240m  [38;2;240;240;240m[48;2;255;15;175m[38;2;240;240;240mif[38;2;0;0;0m[48;2;255;40;183m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;67;192m[38;2;0;0;0mif[38;2;0;0;0m[48;2;255;94;201m[38;2;0;0;0m  [38;2;0;0;0m[48;2;255;121;210m[38;2;0;0;0mif[38;2;0;0;0m[48;2;255;255;255m[38;2;0;0;0m  [0m
EOF
RUN

NAME=prc single-char-flag fix
FILE=-
CMDS=<<EOF
woe 0 0xff 1
f s @ 0x77
prc 256
EOF
EXPECT=<<EOF
0x00000000                                 
0x00000010                                 
0x00000020 ................................
0x00000030 ................................
0x00000040 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
0x00000050 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
0x00000060 ::::::::::::::::::::::::::::::::
0x00000070 :::::::::::::: s::::::::::::::::
0x00000080 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0x00000090 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0x000000a0 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
0x000000b0 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
0x000000c0 OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
0x000000d0 OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
0x000000e0 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
0x000000f0 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##
EOF
RUN

NAME=prc hex.offset=0
FILE=-
CMDS=<<EOF
e hex.offset=0
woe 0 0xff 1
f s @ 0x77
prc 256
EOF
EXPECT=<<EOF
                                
                                
................................
................................
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
::::::::::::::::::::::::::::::::
:::::::::::::: s::::::::::::::::
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##
EOF
RUN

NAME=p=e hex.offset=0
FILE=-
CMDS=<<EOF
e hex.offset=0
e scr.color=0
woe 0 0xff 1
p=e 10
EOF
EXPECT=<<EOF
000 00ff |#
001 00ff |#
002 00ff |#
003 00ff |#
004 00ff |###################################################
005 0006 |#
006 0000 |#
007 0000 |#
008 0000 |#
009 0000 |#
EOF
RUN

NAME=pxA hex.offset=0
FILE=-
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
e hex.offset=0
e scr.color=0
woe 0 0xff 1
pxA 10
EOF
EXPECT=<<EOF
++++++    _|  10
EOF
RUN
