NAME=entrypoint on object
FILE=../bins/elf/pngrutil_o
CMDS=ie
EXPECT=<<EOF
[Entrypoints]

0 entrypoints
EOF
RUN


NAME=symbols non common LD script
FILE=../bins/elf/analysis/custom_ldscript
CMDS=is
EXPECT=<<EOF
[Symbols]

nth paddr       vaddr      bind   type   size lib name
------------------------------------------------------
1    0x00000200 0x00400200 LOCAL  SECT   0        .interp
2    0x0000022c 0x0040022c LOCAL  SECT   0        .note.ABI-tag
3    0x00000250 0x00400250 LOCAL  SECT   0        .hash
4    0x00000278 0x00400278 LOCAL  SECT   0        .dynsym
5    0x000002f0 0x004002f0 LOCAL  SECT   0        .dynstr
6    0x00000334 0x00400334 LOCAL  SECT   0        .gnu.version
7    0x00000340 0x00400340 LOCAL  SECT   0        .gnu.version_r
8    0x00000360 0x00400360 LOCAL  SECT   0        .rela.got
9    0x00000378 0x00400378 LOCAL  SECT   0        .rela.plt
10   0x000003d8 0x004003d8 LOCAL  SECT   0        .init
11   0x00000400 0x00400400 LOCAL  SECT   0        .plt
12   0x00000450 0x00400450 LOCAL  SECT   0        .text
13   0x00000524 0x00400524 LOCAL  SECT   0        .fini
14   0x00000530 0x00400530 LOCAL  SECT   0        .rodata
15   0x00000550 0x00400550 LOCAL  SECT   0        .eh_frame
16   0x00000660 0x00600660 LOCAL  SECT   0        .dynamic
17   0x000007f0 0x006007f0 LOCAL  SECT   0        .got
18   0x000007f8 0x006007f8 LOCAL  SECT   0        .got.plt
19   0x00000830 0x00600830 LOCAL  SECT   0        .data
20   0x00000838 0x01a00838 LOCAL  SECT   0        .custom_sect
21   0x00200840 0x01c00840 LOCAL  SECT   0        .custom_sect2
22   0x00200844 0x01c00844 LOCAL  SECT   0        .custom_text
23   ---------- 0x00000000 LOCAL  SECT   0        .comment
24   ---------- 0x00000000 LOCAL  FILE   0        custom_ldscript.c
25   ---------- 0x00000000 LOCAL  FILE   0
26   0x00000660 0x00600660 LOCAL  NOTYPE 0        __init_array_end
27   0x00000660 0x00600660 LOCAL  OBJ    0        _DYNAMIC
28   0x00000660 0x00600660 LOCAL  NOTYPE 0        __init_array_start
29   0x000007f8 0x006007f8 LOCAL  OBJ    0        _GLOBAL_OFFSET_TABLE_
30   0x00000520 0x00400520 GLOBAL FUNC   2        __libc_csu_fini
31   0x00000830 0x00600830 WEAK   NOTYPE 0        data_start
32   ---------- 0x00600834 GLOBAL NOTYPE 0        _edata
33   0x00000524 0x00400524 GLOBAL FUNC   0        _fini
35   0x00000450 0x00400450 GLOBAL FUNC   49       process
37   0x00000830 0x00600830 GLOBAL NOTYPE 0        __data_start
39   0x00000548 0x00400548 GLOBAL OBJ    4        _IO_stdin_used
40   0x000004b0 0x004004b0 GLOBAL FUNC   101      __libc_csu_init
41   ---------- 0x00600838 GLOBAL NOTYPE 0        _end
42   0x00000481 0x00400481 GLOBAL FUNC   0        _start
43   ---------- 0x00600834 GLOBAL NOTYPE 0        __bss_start
44   0x00200844 0x01c00844 GLOBAL FUNC   128      main
45   0x00000838 0x01a00838 GLOBAL OBJ    8        obj
47   0x00200840 0x01c00840 GLOBAL OBJ    4        glob
48   0x000003d8 0x004003d8 GLOBAL FUNC   0        _init
1    0x00000410 0x00400410 GLOBAL FUNC   16       imp.printf
2    0x00000420 0x00400420 GLOBAL FUNC   16       imp.__libc_start_main
3    0x00000430 0x00400430 WEAK   NOTYPE 16       imp.__gmon_start__
4    0x00000440 0x00400440 GLOBAL FUNC   16       imp.atoi
EOF
RUN

NAME=symbols with no sections header information
FILE=../bins/elf/analysis/main_nosect
CMDS=is
EXPECT=<<EOF
[Symbols]

nth paddr       vaddr      bind   type   size lib name
------------------------------------------------------
1    0x000003e0 0x004003e0 GLOBAL FUNC   16       imp.puts
2    0x000003f0 0x004003f0 GLOBAL FUNC   16       imp.__libc_start_main
3    0x00000400 0x00400400 WEAK   NOTYPE 16       imp.__gmon_start__
EOF
RUN

NAME=symbols with no sections header information 2
FILE=../bins/elf/analysis/clark
CMDS=is
EXPECT=<<EOF
[Symbols]

nth paddr       vaddr      bind   type   size lib name
------------------------------------------------------
8    0x000007dc 0x080487dc GLOBAL OBJ    4        _IO_stdin_used
1    0x00000370 0x08048370 GLOBAL FUNC   16       imp.mprotect
2    0x00000380 0x08048380 GLOBAL FUNC   16       imp.puts
3    0x00000390 0x08048390 WEAK   NOTYPE 16       imp.__gmon_start__
4    0x000003a0 0x080483a0 GLOBAL FUNC   16       imp.exit
5    0x000003b0 0x080483b0 GLOBAL FUNC   16       imp.__libc_start_main
6    0x000003c0 0x080483c0 GLOBAL FUNC   16       imp.ptrace
7    0x000003d0 0x080483d0 GLOBAL FUNC   16       imp.calloc
EOF
RUN

NAME=special ARM symbols with dot
FILE=../bins/elf/special-sym-with-dot.bin
CMDS=pd 5 @ 0x464
EXPECT=<<EOF
            ;-- main:
            0x00000464      80b5           push {r7, lr}
            0x00000466      6f46           mov r7, sp
            0x00000468      82b0           sub sp, 8
            0x0000046a      69ec1623       stcl p3, c2, [sb], -0x58
            0x0000046e      0548           ldr r0, [0x00000484]        ; [0x484:4]=28 ; 1156
EOF
RUN

NAME=symname just before end of dynstr section of size 1
FILE=../bins/elf/switch-hello-world.elf
CMDS=isq~?
EXPECT=<<EOF
1732
EOF
RUN
